"use strict";(self.webpackChunkevent_reservation_app_docs=self.webpackChunkevent_reservation_app_docs||[]).push([[8727],{4726:(e,s,a)=>{a.r(s),a.d(s,{assets:()=>c,contentTitle:()=>t,default:()=>u,frontMatter:()=>d,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"backend/Features/feature-template/database","title":"02-database","description":"Archivo: 02-database.md","source":"@site/docs/backend/Features/00-feature-template/02-database.md","sourceDirName":"backend/Features/00-feature-template","slug":"/backend/Features/feature-template/database","permalink":"/EventResourceReservationAppDocs/en/docs/backend/Features/feature-template/database","draft":false,"unlisted":false,"editUrl":"https://github.com/jose-angell/EventResourceReservationAppDocs/docs/backend/Features/00-feature-template/02-database.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"02-database"},"sidebar":"backendSidebar","previous":{"title":"01-overview","permalink":"/EventResourceReservationAppDocs/en/docs/backend/Features/feature-template/overview"},"next":{"title":"03-endpoints","permalink":"/EventResourceReservationAppDocs/en/docs/backend/Features/feature-template/endpoints"}}');var r=a(4848),i=a(8453);const d={sidebar_position:2,title:"02-database"},t="\ud83d\udce6 Modelo de datos",c={},o=[{value:"1. Entidades nuevas o modificadas",id:"1-entidades-nuevas-o-modificadas",level:2},{value:"Opci\xf3n A: Definici\xf3n con Esquema SQL (CREATE TABLE)",id:"opci\xf3n-a-definici\xf3n-con-esquema-sql-create-table",level:3},{value:"Opci\xf3n B: Definici\xf3n con Clases de C# (EF Core Entities)",id:"opci\xf3n-b-definici\xf3n-con-clases-de-c-ef-core-entities",level:3},{value:"2. Migraciones de Base de Datos",id:"2-migraciones-de-base-de-datos",level:2},{value:"3. Relaciones e \xcdndices",id:"3-relaciones-e-\xedndices",level:2}];function l(e){const s={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"-modelo-de-datos",children:"\ud83d\udce6 Modelo de datos"})}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Archivo:"})," ",(0,r.jsx)(s.code,{children:"02-database.md"})]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Este documento describe las ",(0,r.jsx)(s.strong,{children:"entidades, tablas, migraciones y relaciones"})," de base de datos asociadas a la implementaci\xf3n de esta feature, asegurando la consistencia y la trazabilidad de los cambios en el esquema."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"1-entidades-nuevas-o-modificadas",children:"1. Entidades nuevas o modificadas"}),"\n",(0,r.jsxs)(s.p,{children:["Aqu\xed se definen las entidades de dominio y su mapeo a la base de datos (tablas, agregados). Puedes presentarlas con su ",(0,r.jsx)(s.strong,{children:"esquema SQL"})," o mediante las ",(0,r.jsx)(s.strong,{children:"clases de C# (modelos de EF Core)"})," que las representan. Se recomienda incluir una breve descripci\xf3n de cada entidad/tabla y sus campos m\xe1s relevantes."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"opci\xf3n-a-definici\xf3n-con-esquema-sql-create-table",children:"Opci\xf3n A: Definici\xf3n con Esquema SQL (CREATE TABLE)"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"-- Ejemplo: Entidad 'Reservation'\r\nCREATE TABLE Reservations (\r\n  Id UUID PRIMARY KEY NOT NULL,\r\n  ResourceId UUID NOT NULL,            -- Clave for\xe1nea a la tabla Resources\r\n  UserId UUID NOT NULL,                -- Clave for\xe1nea a la tabla Users\r\n  StartTime TIMESTAMP WITH TIME ZONE NOT NULL,\r\n  EndTime TIMESTAMP WITH TIME ZONE NOT NULL,\r\n  Status VARCHAR(50) NOT NULL,         -- Ej: 'Pending', 'Confirmed', 'Cancelled'\r\n  CreatedAt TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\r\n  UpdatedAt TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\r\n  -- Agrega aqu\xed otras columnas relevantes\r\n);\r\n\r\nCOMMENT ON TABLE Reservations IS 'Almacena la informaci\xf3n de las reservas de recursos.';\r\nCOMMENT ON COLUMN Reservations.Status IS 'Estado actual de la reserva (Pendiente, Confirmada, Cancelada).';\n"})}),"\n",(0,r.jsx)(s.h3,{id:"opci\xf3n-b-definici\xf3n-con-clases-de-c-ef-core-entities",children:"Opci\xf3n B: Definici\xf3n con Clases de C# (EF Core Entities)"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-c#",children:"// Ejemplo: Entidad 'Reservation' (Domain Layer)\r\nnamespace ResourceReservationApp.Domain.Entities\r\n{\r\n    public class Reservation\r\n    {\r\n        public Guid Id { get; private set; }\r\n        public Guid ResourceId { get; private set; } // Referencia al recurso reservado\r\n        public Guid UserId { get; private set; }     // Referencia al usuario que realiza la reserva\r\n        public DateTimeOffset StartTime { get; private set; }\r\n        public DateTimeOffset EndTime { get; private set; }\r\n        public ReservationStatus Status { get; private set; } // Enum o string\r\n        public DateTimeOffset CreatedAt { get; private set; }\r\n        public DateTimeOffset UpdatedAt { get; private set; }\r\n\r\n        // Constructor y m\xe9todos para la l\xf3gica de negocio\r\n    }\r\n\r\n    // Ejemplo de Enum (si aplica)\r\n    public enum ReservationStatus\r\n    {\r\n        Pending,\r\n        Confirmed,\r\n        Cancelled\r\n    }\r\n}\r\n\r\n// Consideraciones de Mapeo EF Core (Infrastructure Layer - DbContext)\r\n// Puedes a\xf1adir aqu\xed ejemplos de configuraciones Fluent API si son complejas.\r\n// Por ejemplo: entity.Property(e => e.Status).HasConversion<string>();\n"})}),"\n",(0,r.jsx)(s.h2,{id:"2-migraciones-de-base-de-datos",children:"2. Migraciones de Base de Datos"}),"\n",(0,r.jsx)(s.p,{children:"Lista todas las migraciones de EF Core creadas o modificadas para esta feature. Esto proporciona un historial claro de c\xf3mo evolucion\xf3 el esquema de la base de datos."}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"YYYYMMDD_NombreDescriptivoDeLaMigracion"}),": Objetivo de la migraci\xf3n.","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"20250708_AddReservationAndResourceTables"}),": Crea las tablas ",(0,r.jsx)(s.code,{children:"Reservations"})," y ",(0,r.jsx)(s.code,{children:"Resources"})," con sus campos iniciales."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"20250710_AddReservationStatusEnum"}),": Agrega la columna ",(0,r.jsx)(s.code,{children:"Status"})," a la tabla ",(0,r.jsx)(s.code,{children:"Reservations"})," y la mapea a un ",(0,r.jsx)(s.code,{children:"enum"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"20250712_AddUniqueIndexOnResourceTime"}),": A\xf1ade un \xedndice \xfanico para evitar reservas duplicadas del mismo recurso a la misma hora."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"3-relaciones-e-\xedndices",children:"3. Relaciones e \xcdndices"}),"\n",(0,r.jsx)(s.p,{children:"Documenta las relaciones entre tablas (claves for\xe1neas) y los \xedndices creados para optimizar el rendimiento de las consultas y asegurar la integridad de los datos."}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Columna"}),(0,r.jsxs)(s.th,{children:["Tipo Tipo / Cardinalidad ",(0,r.jsx)("br",{})," (FK/INDEX)"]}),(0,r.jsx)(s.th,{children:"Columna Destino (si es FK)"}),(0,r.jsx)(s.th,{children:"Prop\xf3sito / Justificaci\xf3n"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<Tabla>.<Campo>"})}),(0,r.jsx)(s.td,{children:"FK"}),(0,r.jsx)(s.td,{children:"OtraTabla(Id)"}),(0,r.jsx)(s.td,{children:"Integridad referencial"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"<Tabla>.<Campo2>"})}),(0,r.jsx)(s.td,{children:"INDEX"}),(0,r.jsx)(s.td,{children:"N/A"}),(0,r.jsx)(s.td,{children:"Optimizar consultas X"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Reservations.ResourceId"})}),(0,r.jsxs)(s.td,{children:["FK (1",":N",")"]}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Resources.Id"})}),(0,r.jsx)(s.td,{children:"Integridad referencial: Asegura que una reserva siempre apunte a un recurso existente."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Reservations.UserId"})}),(0,r.jsxs)(s.td,{children:["FK (1",":N",")"]}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Users.Id"})}),(0,r.jsx)(s.td,{children:"Integridad referencial: Vincula la reserva a un usuario espec\xedfico."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Reservations.StartTime"})}),(0,r.jsx)(s.td,{children:"INDEX"}),(0,r.jsx)(s.td,{children:"N/A"}),(0,r.jsx)(s.td,{children:"Optimizar consultas por rango de fechas de reserva."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Reservations.EndTime"})}),(0,r.jsx)(s.td,{children:"INDEX"}),(0,r.jsx)(s.td,{children:"N/A"}),(0,r.jsx)(s.td,{children:"Optimizar consultas por rango de fechas de reserva."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Resources.Name"})}),(0,r.jsx)(s.td,{children:"INDEX (Unique)"}),(0,r.jsx)(s.td,{children:"N/A"}),(0,r.jsx)(s.td,{children:"Asegura que los nombres de los recursos sean \xfanicos para facilitar b\xfasquedas."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"Reservations.ResourceId, StartTime, EndTime"})}),(0,r.jsx)(s.td,{children:"INDEX (Unique Composite)"}),(0,r.jsx)(s.td,{children:"N/A"}),(0,r.jsx)(s.td,{children:"Previene la doble reserva del mismo recurso para el mismo intervalo de tiempo."})]})]})]})]})}function u(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,s,a)=>{a.d(s,{R:()=>d,x:()=>t});var n=a(6540);const r={},i=n.createContext(r);function d(e){const s=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),n.createElement(i.Provider,{value:s},e.children)}}}]);